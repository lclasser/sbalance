<style>.input_check{flex:1 0 auto}.input_select{display:flex;flex-direction:row;flex:1 0 auto;justify-content:flex-end}.input_select select{width:auto}</style><div page-declare=dpage class="page-column sb-page" onload=onPageLoad(this)><div class="mb-1 align-items-center column-fixed d-flex flex-row flex-wrap m-0 p-1"><div class="p-1 input_check"><input class=form-check-input type=checkbox id=item_all> <label class=form-check-label for=item_all id=item_qty>선택</label></div><div class=input_select><select class="m-1 form-select" id=disp_type style=width:auto><option class=fs_item value=ALL selected=selected>모두 보기<option class=fs_item value=SERVER>저장된거만 보기<option class=fs_item value=CLIENT>장치거만 보기</select> <button type=button class="m-1 btn btn-primary" id=btn_add>추가하기</button> <button type=button class="m-1 btn btn-primary" id=btn_refresh>재조회</button></div></div><div class="mb-1 column-paged sb-list" id=data_list></div></div><script>function onPageLoad(e){var i=e.getPage(),c=e.getParam();function d(e,d){readDeviceMessages({date1:e,date2:d}).then(function(e){var t=i.find("#data_list");function s(){i.find("#item_qty").html(`선택: ${t.find("#msg_check:checked").length} 건<br>전체: ${e.row_record.length} 건`)}t.empty(),e.row_record.sort(function(e,d){return e.msg_date>d.msg_date?-1:e.msg_date<d.msg_date?1:e.msg_time>d.msg_time?-1:e.msg_time<d.msg_time?1:0});stracer("page.message_read.html").log("list... :",e.row_record),e.row_record.forEach(function(e,d){0<d&&t.append('<div class="list-line">');var i=$(`
    <div class="list-row m-0" style="align-items:start !important;height:72px;">
        <div class="d-flex flex-column p-1 w-100">
            <div class="d-flex flex-row">
                <div class="pe-1">
                    <input class="form-check-input" type="checkbox" id="msg_check">
                </div>
                <div class="pe-3" id="msg_date">날짜</div>
                <div class="me-auto" id="msg_time">시간</div>
                <div class="" id="msg_phone">수신번호</div>
            </div>
            <div class="d-flex flex-row">
                <div class="p-1" style="width: 1em;"></div>
                <div class="d-flex align-items-center" id="msg_body">내용</div>
            </div>
        </div>
    </div>
    `);1==e.is_found?(i.addClass("text-secondary"),i.find("#msg_check").prop("disabled",!0)):0==e.is_found?i.addClass("text-primary"):(i.addClass("text-danger"),i.find("#msg_check").prop("disabled",!0)),delete e.is_found,i.find("#msg_check").change(function(){s()}),i.find("#msg_check").prop("midx",d),i.find("#msg_phone").html(e.msg_phone),i.find("#msg_date").html(e.msg_date.substring(4,6)+"-"+e.msg_date.substring(6,8)),i.find("#msg_time").html(e.msg_time.substring(0,2)+":"+e.msg_time.substring(2,4)),i.find("#msg_body").html(e.msg_body),i.click(function(e){"msg_check"!=e.target.id&&1!=i.find("#msg_check").prop("disabled")&&(i.find("#msg_check").prop("checked",!i.find("#msg_check").prop("checked")),s())}),t.append(i)}),c.row_record=e.row_record,s(),i.find("#item_all").unbind("click").bind("click",function(){i.find("#msg_check:not(:disabled)").prop("checked",i.find("#item_all").prop("checked")),s()})})}stracer("page.message_read.html").log("pparam:",c),d(c.date1,c.date2),i.find("#btn_add").click(function(){var e=i.find("#msg_check:checked").toArray();e.length<=0?window.toast({title_class:"bg-secondary text-white",title_text:"문자 읽기",mesg_text:"추가할 문자를 선택해 주세요."}):insertDeviceMessages(e,{findItem:function(e){e=$(e).prop("midx");return c.row_record[e]},onFinish:function(){d(c.date1,c.date2)},onError:function(){}})}),i.find("#btn_refresh").click(function(){d(c.date1,c.date2)})}</script>