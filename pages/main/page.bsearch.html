<style>
    /* 일별,달력,분류,지갑 등 */
    #page-bsearch .daily-type {
        font-family: Noto Sans;
        font-weight: 400 !important;
        font-size: var(--theme-font-size-3);
        line-height: 20px;
        opacity: 1;
        text-align: center;
        padding: 7px 5px;
        opacity: 1;
        overflow: hidden;
        cursor: pointer;
        color: rgba(218,213,209,1);
        border-style: solid;
        border-width: 0px;
        border-color: #DBD5D2;
        border-top-width: 1px;
        border-bottom-width: 1px;
        border-left-width: 1px;
        user-select: none;
        -webkit-user-select: none;
    }
    #page-bsearch .daily-type:first-child {
        border-top-left-radius: 4px;
        border-bottom-left-radius: 4px;
        border-left-width: 1px;
    }
    #page-bsearch .daily-type:last-child {
        border-top-right-radius: 4px;
        border-bottom-right-radius: 4px;
        border-right-width: 1px;
    }
    #page-bsearch .daily-type.actived {
        color: rgba(34,34,35,1);
        background: linear-gradient(rgba(255,200,76,1), rgba(252,128,50,1));
        font-weight: 500 !important;
        border-color: transparent;
        border-top-color: rgba(255,200,76,1);
        border-bottom-color: rgba(252,128,50,1);
    }
    #page-bsearch .daily-type.actived + .daily-type{
        --border-color: #3C97F5;
        border-left-color: transparent;
    }
    #page-bsearch .daily-type:hover:not(.actived) {
        color: #575552;
        background: #343434;
    }
</style>
<div page-declare="dpage" class="w-100 h-100" onload="onPageLoad(this);" onclose="onPageClose(this);">
    <div class="h-100 w-100 d-flex flex-column" id="page-bsearch">
        <div class="w-100 p-1 d-flex flex-column">
            <!-- date control -->
            <div class="d-flex w-100">
                <!-- 일별,달력,분류,지갑 등 -->
                <div class="d-flex ms-1">
                    <div class="daily-type" page-link="https://lclasser.github.io/sbalance/pages/main/balance/page.daily.html">검색</div>
                    <div class="daily-type" page-link="https://lclasser.github.io/sbalance/pages/main/balance/page.calendar.html">추천</div>
                </div>
                <!-- 필터 -->
                <div class="d-flex ms-auto h-100 me-1">
                    <img src="https://lclasser.github.io/sbalance/public/image/filter.svg">
                </div>
            </div>
        </div>
        <!-- Page -->
        <div class="p-1" style="flex: 1; overflow: auto;" id="bsearch_body">
            <!-- 날짜 -->

            <div class="d-flex input-group">
                <span class="col-2 input-group-text fs_item">시작 날짜</span>
                <input type="button" class="form-control date datetimepicker-input fs_item" id="search_date1" data-target="#search_date1" data-toggle="datetimepicker"/>
            </div>

            <div class="d-flex input-group">
                <span class="col-2 input-group-text fs_item">종료 날짜</span>
                <input type="button" class="form-control date datetimepicker-input fs_item" id="search_date2" data-target="#search_date2" data-toggle="datetimepicker"/>
            </div>

            <!-- 검색어 -->
            <div class="d-flex input-group">
                <span class="col-2 input-group-prepend input-group-text">검색어</span>
                <input class="form-control" type="text" id="search_word" placeholder="내용과 메모에서 검색합니다.">
                <button class="input-group-append btn btn-primary" type="button" id="search_btn">검색</button>
            </div>
            <div id="search_result">

            </div>
        </div>

    </div>
</div>

<link href="https://lclasser.github.io/sbalance/pages/main/balance/page.daily.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="https://lclasser.github.io/sbalance/pages/main/balance/page.daily.js"></script>
<script>
function onPageLoad(epage)
{
    var now_date = new Date();
    var now_date1 = new Date(now_date.getFullYear()-1, now_date.getMonth(), now_date.getDay());
    var now_date2 = new Date(now_date.getFullYear(), now_date.getMonth(), now_date.getDay());

    $('#search_date1').datetimepicker({
        dayViewHeaderFormat: 'YYYY-MM',
        format: 'YYYY-MM-DD',
        locale: 'ko',
        date  : now_date1,
    });

    $('#search_date2').datetimepicker({
        dayViewHeaderFormat: 'YYYY-MM',
        format: 'YYYY-MM-DD',
        locale: 'ko',
        date  : now_date2,
    });

    $("#search_btn").click(function() {
        var inbound = {
            search_word  : $("#search_word").val(),
            search_date1 : formaterFmtDate_fromDate($('#search_date1').datetimepicker('viewDate').toDate()),
            search_date2 : formaterFmtDate_fromDate($('#search_date2').datetimepicker('viewDate').toDate()),
        };

        window.SBalance.request('/main/message/search', inbound)
        .then(function(result) {
            if( result.error.success != 'Y' ) {
                console.error(`message_url res:`, result);
                window.toast({
                    title_class: `bg-danger text-white`,
                    title_text: "검색 정보",
                    mesg_text: "검색을 실패 했습니다.",
                });
                return;
            }

            console.log("result:", result);

            // page.daily.js
            var options = {
                show_ads : false,
                show_month : true,
                read_only : true,
            };
            process_data_daily($("#search_result"), null, options, result.data, function() {
                // onRefresh
                console.log("refresh...");
            });
        });
    });
}

function onPageClose(epage)
{
    STracer("page.setup.html").dbg("onPageClose:", epage);
}
</script>
