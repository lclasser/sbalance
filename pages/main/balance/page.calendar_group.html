<style>.scalendar{width:100%}.scalendar table{border-collapse:collapse;border:.5px solid #5d5d5d;width:100%;background:rgba(113,113,113,.1)}.scalendar table thead th{height:23px;border-collapse:collapse;border:.5px solid #5d5d5d;background:rgba(77,77,77,.8);color:#dbd5d2;text-align:right;font-size:12px;font-family:"Noto Sans";font-weight:500;line-height:20px;letter-spacing:-.36px;padding:0 4px}.scalendar td{--height:81px;min-height:56px;padding:3px;vertical-align:top;border-collapse:collapse;border:.5px solid #5d5d5d;max-width:50px}.scalendar .sbc_td{width:100%;height:100%;display:flex;flex-direction:column}.scalendar .sbc_head{font-size:12px}.scalendar .sbc_head ._day{text-align:right}.scalendar .sbc_head .sbc_curr{color:#000}.scalendar .sbc_head .sbc_nurr{color:#7a7d7c}.scalendar .sbc_head ._day.sbc_curr.week_red{color:red}.scalendar .sbc_head ._day.sbc_curr.week_blue{color:#00f}.scalendar .sbc_head ._day.sbc_curr.week_norm{color:#babdbc}.scalendar .sbc_body{width:100%;height:100%;color:#babdbc}#unit,.scalendar .sbc_body #amt{font-size:12px}.scalendar .sbc_body .amount-deposit{justify-content:flex-end}</style><link href=https://lclasser.github.io/sbalance/pages/main/balance/page.daily.css rel=stylesheet><div page-declare=dpage class=sb-page onopen=onPageOpen(this)><div class="w-100 scalendar"><table cellspacing=0 cellpadding=0><col width=13%><col width=13%><col width=13%><col width=13%><col width=13%><col width=13%><col width=13%><thead><tr><th scope=col><span>일</span><th scope=col><span>월</span><th scope=col><span>화</span><th scope=col><span>수</span><th scope=col><span>목</span><th scope=col><span>금</span><th scope=col><span>토</span><tbody class=_calendarTableBody></table></div><div id=list_daily class=w-100></div></div><script>function inquire_daily(t,a,e){var d,n;a=a||t.last_date,stracer("page.calendar_group.html").log("fmt_date:",a),null!=a&&(n=t.getFrame().getBalanceSum(),n={year:(d=formaterNewDate_fromFmtDate(a)).getFullYear(),month:d.getMonth()+1,day:d.getDate(),sms_class:n&&n[0].getSummaryClass(),options:{show_ads:!1}},new Date(d.getFullYear(),d.getMonth()+1,0).getDate()==d.getDate()&&(n.is_lastday=!0),t.last_date=a,process_daily(t,t.find("#list_daily"),n,function(t){}))}function inquire_calendar(l,_,c){return stracer("page.calendar_group.html").log("inbound:",_),window.SBalance.request("/main/message/calendar",_).then(function(n){stracer("page.calendar_group.html").log("inquire_calendar 1:",n);var t,s={},a=(n.data.forEach(function(t,a){var e,d=formaterNewDate_fromFmtDate(t.sms_date);d.getMonth()+1!=_.month?((e=new Date(d.getFullYear(),_.month,0)).getDate()<=d.getDate()?d=e:d.setMonth(_.month-1),t.sms_date=formaterFmtDate_fromDate(d),s[t.sms_date]=s[t.sms_date]||{deposit_amount:0,deposit_count:0,withdraw_amount:0,withdraw_count:0},(e=s[t.sms_date]).deposit_amount+=t.deposit_amount,e.deposit_count+=t.deposit_count,e.withdraw_amount+=t.withdraw_amount,e.withdraw_count+=t.withdraw_count,delete n.data[a]):null!=(e=s[t.sms_date])&&(t.deposit_amount+=e.deposit_amount,t.deposit_count+=e.deposit_count,t.withdraw_amount+=e.withdraw_amount,t.withdraw_count+=e.withdraw_count)}),n.data=n.data.filter(t=>null!=t),n.data.sort(function(t,a){return t.sms_date-a.sms_date}),stracer("page.calendar_group.html").log("inquire_calendar 2:",n),{sum_count:0,sum_withdraw:amountAdd(),sum_deposit:amountAdd()}),e=(l.find("._calendarTableBody").empty(),new Date(_.year,_.month-1,1)),d=new Date(e),o=(d.setDate(d.getDate()-e.getDay()),{item:null,pos:0,date:null});for(wpos=0;wpos<6;wpos++){for(t=$("<tr>"),dpos=0;dpos<7;dpos++){var r=$(`
        <td><div  class="sbc_td">
            <div class="sbc_head"> <div class="_day">1</div> </div>
            <div class="sbc_body"> </div>
        </div></td>
        `),i=(o.item=null,o.pos<n.data.length&&(o.date=formaterNewDate_fromFmtDate(n.data[o.pos].sms_date)),null!=o.date&&d.getMonth()==o.date.getMonth()&&d.getDate()==o.date.getDate()&&(o.item=n.data[o.pos],o.pos++,amountAdd(a.sum_withdraw,o.item.withdraw_amount),amountAdd(a.sum_deposit,o.item.deposit_amount),a.sum_count++),r.find(".sbc_head")),m=(i.attr("cdate",formaterFmtDate_fromDate(d)),i.find("._day"));switch(m.html(d.getDate()),d.getMonth()==e.getMonth()?m.addClass("sbc_curr"):m.addClass("sbc_nurr"),d.getDay()){case 0:m.addClass("week_red");break;case 6:m.addClass("week_blue");break;default:m.addClass("week_norm")}var i=r.find(".sbc_body"),u="-",u=(o.item&&0<o.item.withdraw_count&&(u=thousandFormatter(o.item.withdraw_amount)),i.append('<div class="d-flex justify-content-end amount-withdraw">'+`<div class="text-truncate" id="amt">${u}</div>`+"</div>"),"-");o.item&&0<o.item.deposit_count&&(u=thousandFormatter(o.item.deposit_amount)),i.append('<div class="d-flex justify-content-end amount-deposit">'+`<div class="text-truncate" id="amt">${u}</div>`+"</div>"),r.click(function(){var t=$(this).find(".sbc_head").attr("cdate");return inquire_daily(l,t,function(){}),!1}),d.setDate(d.getDate()+1),t.append(r)}if(l.find("._calendarTableBody").append(t),d.getMonth()!=e.getMonth())break}c(a)})}function onPageOpen(t){var e=t.getPage(),d=e.getReference("balances");function n(){var a=e.getFrame().getBalanceSum(),t={year:d.now_date.getFullYear(),month:d.now_date.getMonth()+1,sms_class:a&&a[0].getSummaryClass()},t=Object.assign(t,d.filter);inquire_calendar(e,t,function(t){a&&a[0].setSummaryResult(t,n)})}e.on("refresh",function(t,a){return stracer("page.calendar.html").log("event.refresh:",t,a),n(),e.find("#list_daily").empty(),!0}),n()}</script>