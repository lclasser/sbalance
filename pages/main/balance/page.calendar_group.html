<style>.scalendar{width:100%}.scalendar table{border-collapse:collapse;border:.5px solid #5d5d5d;width:100%;background:rgba(113,113,113,.1)}.scalendar table thead th{height:23px;border-collapse:collapse;border:.5px solid #5d5d5d;background:rgba(77,77,77,.8);color:#dbd5d2;text-align:right;font-size:12px;font-family:"Noto Sans";font-weight:500;line-height:20px;letter-spacing:-.36px;padding:0 4px}.scalendar td{--height:81px;min-height:56px;padding:3px;vertical-align:top;border-collapse:collapse;border:.5px solid #5d5d5d;max-width:50px}.scalendar .sbc_td{width:100%;height:100%;display:flex;flex-direction:column}.scalendar .sbc_head{font-size:12px}.scalendar .sbc_head ._day{text-align:right}.scalendar .sbc_head .sbc_curr{color:#000}.scalendar .sbc_head .sbc_nurr{color:#7a7d7c}.scalendar .sbc_head ._day.sbc_curr.week_red{color:red}.scalendar .sbc_head ._day.sbc_curr.week_blue{color:#00f}.scalendar .sbc_head ._day.sbc_curr.week_norm{color:#babdbc}.scalendar .sbc_body{width:100%;height:100%;color:#babdbc}#unit,.scalendar .sbc_body #amt{font-size:12px}.scalendar .sbc_body .amount-deposit{justify-content:flex-end}</style><link href=https://lclasser.github.io/sbalance/pages/main/balance/page.daily.css rel=stylesheet><div page-declare=dpage class=sb-page onopen=onPageOpen(this)><div class="w-100 scalendar"><table cellspacing=0 cellpadding=0><col width=13%><col width=13%><col width=13%><col width=13%><col width=13%><col width=13%><col width=13%><thead><tr><th scope=col><span>일</span><th scope=col><span>월</span><th scope=col><span>화</span><th scope=col><span>수</span><th scope=col><span>목</span><th scope=col><span>금</span><th scope=col><span>토</span><tbody class=_calendarTableBody></table></div><div id=list_daily class=w-100></div></div><script>function inquire_daily(t,e,a){var n,d;e=e||t.last_date,stracer("page.calendar_group.html").log("fmt_date:",e),null!=e&&(d=t.getFrame().getBalanceSum(),d={year:(n=formaterNewDate_fromFmtDate(e)).getFullYear(),month:n.getMonth()+1,day:n.getDate(),sms_class:d&&d[0].getSummaryClass(),options:{show_ads:!1}},new Date(n.getFullYear(),n.getMonth()+1,0).getDate()==n.getDate()&&(d.is_lastday=!0),t.last_date=e,process_daily(t,t.find("#list_daily"),d,null))}function inquire_calendar(h,t,f){return stracer("page.calendar_group.html").log("inbound:",t),window.SBalance.request("/main/message/calendar",t).then(function(t){stracer("page.calendar_group.html").log("inquire_calendar 1:",t);var e,n={},d=t.data.info,s=t.data.record,a=(s.forEach(function(t,e){var a=formaterNewDate_fromFmtDate(t.sms_date);(d.sdate>t.sms_date||d.edate<t.sms_date)&&(n[a.getDate()]=n[a.getDate()]||{deposit_amount:0,deposit_count:0,withdraw_amount:0,withdraw_count:0},(a=n[a.getDate()]).deposit_amount+=t.deposit_amount,a.deposit_count+=t.deposit_count,a.withdraw_amount+=t.withdraw_amount,a.withdraw_count+=t.withdraw_count,s[e]=null)}),(s=s.filter(t=>null!=t)).sort(function(t,e){return t.sms_date-e.sms_date}),stracer("page.calendar_group.html").log("accum 2:",t),{sum_count:0,sum_withdraw:amountAdd(),sum_deposit:amountAdd()}),t=(h.find("._calendarTableBody").empty(),window.SBalance.getSignin("month_sday"),formaterNewDate_fromFmtDate(d.sdate)),o=new Date(t),r=(o.setDate(o.getDate()-t.getDay()),{item:null,pos:0,date:null,lmonth:null});for(wpos=0;wpos<6;wpos++){for(e=$("<tr>"),dpos=0;dpos<7;dpos++){var i=$(`
        <td><div  class="sbc_td">
            <div class="sbc_head"> <div class="_day">1</div> </div>
            <div class="sbc_body"> </div>
        </div></td>
        `),l=(r.item=null,r.pos<s.length&&(r.date=formaterNewDate_fromFmtDate(s[r.pos].sms_date)),null!=r.date&&o.getMonth()==r.date.getMonth()&&o.getDate()==r.date.getDate()&&(r.item=s[r.pos],r.pos++),formaterFmtDate_fromDate(o)),m=i.find(".sbc_head"),u=(m.attr("cdate",l),m.find("._day"));switch(null==r.lmonth||o.getMonth()!=r.lmonth?u.html(o.getMonth()+1+"."+o.getDate()):u.html(o.getDate()),o.getDay()){case 0:u.addClass("week_red");break;case 6:u.addClass("week_blue");break;default:u.addClass("week_norm")}d.sdate<=l&&d.edate>=l?u.addClass("sbc_curr"):u.addClass("sbc_nurr");var m=i.find(".sbc_body"),c=0,_=0,g=null;d.sdate<=l&&d.edate>=l&&((0<(c=0+toInteger(n[o.getDate()]&&n[o.getDate()].withdraw_amount)+toInteger(r.item&&r.item.withdraw_amount))||r.item&&0<r.item.withdraw_count)&&(g=thousandFormatter(c)),amountAdd(a.sum_withdraw,c)),m.append('<div class="d-flex justify-content-end amount-withdraw">'+`<div class="text-truncate" id="amt">${g||"-"}</div>`+"</div>"),g=null,d.sdate<=l&&d.edate>=l&&((0<(_=0+toInteger(n[o.getDate()]&&n[o.getDate()].deposit_amount)+toInteger(r.item&&r.item.deposit_amount))||r.item&&0<r.item.deposit_count)&&(g=thousandFormatter(_)),amountAdd(a.sum_deposit,_)),m.append('<div class="d-flex justify-content-end amount-deposit">'+`<div class="text-truncate" id="amt">${g||"-"}</div>`+"</div>"),0==toInteger(c)&&0==toInteger(_)||(amountAdd(a.sum_deposit,_),a.sum_count++),i.click(function(){var t=$(this).find(".sbc_head").attr("cdate");return inquire_daily(h,t,function(){}),!1}),r.lmonth=o.getMonth(),o.setDate(o.getDate()+1),e.append(i)}if(h.find("._calendarTableBody").append(e),d.edate<l)break}f(a)})}function onPageOpen(t){var a=t.getPage(),n=a.getReference("balances");function d(){var e=a.getFrame().getBalanceSum(),t={year:n.now_date.getFullYear(),month:n.now_date.getMonth()+1,sms_class:e&&e[0].getSummaryClass()},t=Object.assign(t,n.filter);a.find("#list_daily").empty(),inquire_calendar(a,t,function(t){e&&e[0].setSummaryResult(t,function(){d()})})}a.on("refresh",function(t,e){return stracer("page.calendar.html").log("event.refresh:",t,e),d(),!0}),d()}</script>