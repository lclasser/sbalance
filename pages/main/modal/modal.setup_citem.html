<div class="modal-dialog modal-dialog-centered modal-dialog-scrollable sb-modal" role=document><div class=modal-content><div class=modal-header><h5 class=modal-title id=modal_title>분류 추가</h5><button class=btn-close type=button data-bs-dismiss=modal aria-label=Close></button></div><div class="modal-body sb-form"><div class=sb-row><div class=sb-col><label class="sb-label w-4">분류 그룹</label> <select class=sb-select id=dlg_cgroup></select></div></div><div class=sb-row><div class=sb-col><label class="sb-label w-4">분류 이름</label> <input class=sb-input type=text placeholder="분류 이름" id=dlg_name></div></div><div class=sb-row><div class=sb-col><label class="sb-label w-4">분류 종류</label> <select class=sb-select id=dlg_catetype><option value=N>일반<option value=T>이체 계좌<option value=E>예외 (일별만 표시)</select></div></div><div class=sb-row><div class=sb-col><label class="sb-label w-4">분류 순서</label> <input class=sb-input type=text placeholder="분류 순서" id=dlg_sort></div></div><div class=sb-row><div class=sb-col><label class="sb-label w-4">예산 금액</label> <input class=sb-input type=text placeholder="예산 금액" id=dlg_budget></div></div></div><div class=modal-footer><button type=button id=modal_del class="btn btn-lg btn-danger me-auto">삭제</button> <button type=button id=modal_ok class="btn btn-lg btn-primary">저장</button> <button type=button class="btn btn-lg btn-secondary" data-bs-dismiss=modal>취소</button></div></div></div><script>$(function(){var d=window.dmodal.getModal(),i=window.dmodal.getParam();switch(console.log("param:",i),"L"==i.cg_type?window.SBalance.request("/main/category/group/select").then(function(e){e.data.some(function(e){if(i.cg_key==e.cg_name)return d.find("#dlg_cgroup").append($(`<option class="fs_item" value="${e.cg_name}" selected> ${e.org_desc} (${e.org_email})</option>`)),!0})}):window.SBalance.request("/main/category/group/select").then(function(e){e.data.forEach(function(e){var t;"L"!=e.cg_type&&(t=i.cg_key==e.cg_key?"selected":"",d.find("#dlg_cgroup").append($(`<option class="fs_item" value="${e.cg_key}" ${t}> ${e.cg_name}</option>`)))})}),"L"==i.cg_type&&(d.find("#dlg_cgroup").attr("disabled","disabled"),d.find("#dlg_cgroup").parent().attr("disabled","disabled")),i.ci_sort&&d.find("#dlg_sort").val(i.ci_sort||100),eventInputNumber(d.find("#dlg_sort")[0]),i.ci_type){case"N":case"T":case"E":d.find("#dlg_catetype").val(i.ci_type).prop("selected",!0);break;default:d.find("#dlg_catetype").val("N").prop("selected",!0)}"수정"===i.btn_confirm?(d.find("#modal_ok").html(i.btn_confirm),d.find("#modal_del").show()):d.find("#modal_del").hide(),d.find("#modal_title").html(i.title),d.find("#dlg_name").val(i.ci_name),d.find("#dlg_budget").val(i.ci_budget),eventInputNumber(d.find("#dlg_budget")[0]),$("#modal_del").click(function(){window.openModal("https://lclasser.github.io/sbalance/pages/main/modal/modal.confirm.html",{title:"삭제 확인",content:`"${i.ci_name}" 분류를 삭제 하시겠습니까?`,btn_confirm:"삭제",btn_cancel:"취소"},function(e){1==e&&(window.SBalance.request("/main/category/item/delete",{cg_key:i.cg_key,ci_idx:i.ci_idx}).then(function(e){e.error.success}),window.dmodal.exit(!0))})}),$("#modal_ok").click(function(){var e=d.find("#dlg_cgroup option:selected").val(),t=(e==i.cg_key&&(e=null),d.find("#dlg_sort").val()),t=((null==t||t.length<=0)&&(t=100),{ci_idx:i.ci_idx,cg_key:i.cg_key,ci_name:d.find("#dlg_name").val(),ci_type:d.find("#dlg_catetype option:selected").val(),ci_budget:toInteger(d.find("#dlg_budget").val()),ci_sort:t,target_cg_key:e}),n=(console.log("category update:",t),"/main/category/item/update");null==t.ci_idx&&(n="/main/category/item/insert"),window.SBalance.request(n,t).then(function(e){console.log(n+" res:",e),"Y"==e.error.success?window.dmodal.close(!0):window.dmodal.close()})})})</script>