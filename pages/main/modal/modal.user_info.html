<style>.btn-pwd{align-self:stretch;align-items:center!important;display:flex!important;background-color:#323232!important;display:flex;justify-content:center;padding:0!important;width:40px;border:0!important}.btn-check:focus+.btn-pwd,.btn-pwd:focus{background-color:transparent!important;--color:#E9E6E6!important;outline:0!important;box-shadow:none!important}.btn-check:checked+.btn-pwd,.btn-pwd:checked{background-color:#7c7c7c!important;color:#e9e6e6!important}.btn-pwd:hover{background-color:transparent!important;color:#fff!important}</style><div class="modal-dialog modal-dialog-centered modal-dialog-scrollable sb-modal" role=document><div class=modal-content><div class=modal-header><h5 class=modal-title id=modal_title>사용자 정보 수정</h5><button class=btn-close type=button data-bs-dismiss=modal aria-label=Close></button></div><div class="modal-body sb-form"><div class="sb-col sb-row"><span class="sb-label w-7">e-mail</span> <span class=sb-input id=dlg_usr_email></span></div><div class="sb-col sb-row"><label class="sb-label w-7">이름</label> <input class=sb-input type=text placeholder="사용자 실명" id=dlg_usr_name></div><div class="sb-col sb-row"><label class="sb-label w-7">전화번호</label> <input class=sb-input type=text placeholder=010-0000-0000 id=dlg_usr_phone></div><div class="sb-col sb-row"><label class="sb-label w-7">현재 비밀번호</label> <input class=sb-input type=password id=dlg_usr_pwd placeholder="수정을 위해 반드시 비밀번호를 입력하세요."> <input type=checkbox class=btn-check id=dlg_usr_show autocomplete=off> <label class="btn btn-secondary btn-pwd" for=dlg_usr_show><i class="fa-eye-slash fa-solid"></i></label></div><div class="sb-col sb-row"><label class="sb-label w-7">신규 비밀번호</label> <input class=sb-input type=password id=dlg_new_pwd1 placeholder="입력시 변경됩니다."> <input type=checkbox class=btn-check id=dlg_new_show1 autocomplete=off> <label class="btn btn-secondary btn-pwd" for=dlg_new_show1><i class="fa-eye-slash fa-solid"></i></label></div><div class="sb-col sb-row"><label class="sb-label w-7">비밀번호 확인</label> <input class=sb-input type=password id=dlg_new_pwd2 placeholder="변경된 비밀번호를 입력하세요." disabled=disabled> <input type=checkbox class=btn-check id=dlg_new_show2 autocomplete=off disabled=disabled> <label class="btn btn-secondary btn-pwd" for=dlg_new_show2><i class="fa-eye-slash fa-solid"></i></label></div></div><div class="alert alert-danger alert-dismissible fade me-3 ms-3 p-3 show" id=dlg_error><strong>Error!</strong> <span class="message ml-3">A problem has been occurred while submitting your data.</span></div><div class=modal-footer><button type=button id=modal_del class="btn btn-lg btn-danger me-auto">탈퇴</button> <button type=button id=modal_ok class="btn btn-lg btn-primary">저장</button> <button type=button class="btn btn-secondary btn-lg" data-bs-dismiss=modal>취소</button></div></div></div><script>$(function(){var d=window.dmodal.getModal(),e=window.dmodal.getParam(),l=(stracer("modal.user_info.html").log("param:",e),d.find("#dlg_error").hide(),null);function t(e){d.find("#dlg_error > .message").html(e),d.find("#dlg_error").show(),setTimeout(function(){d.find("#dlg_error").hide()},3e3)}function a(){var e={usr_email:d.find("#dlg_usr_email").html(),usr_name:d.find("#dlg_usr_name").val(),usr_phone:d.find("#dlg_usr_phone").val(),usr_pwd:null},n=d.find("#dlg_usr_pwd").val();return null!=n&&(0<n.length&&(n=SHA_256(n),e.usr_pwd=n),n=null),e}window.SBalance.request("/main/user/select",null).then(function(e){null!=e.error&&"Y"!=e.error.success&&alert(`사용자 정보를 확인할 수 없습니다.(${e.error})`),l=e.data[0],d.find("#dlg_usr_email").html(l.usr_email),d.find("#dlg_usr_name").val(l.usr_name),d.find("#dlg_usr_phone").val(l.usr_phone)}),d.find("#dlg_new_pwd1").keyup(function(){stracer("modal.user_info.html").log("changed");var e=d.find("#dlg_new_pwd1").val();null==e||e.length<=0?(d.find("#dlg_new_pwd2").attr("disabled","disabled"),d.find("#dlg_new_show2").attr("disabled","disabled")):(d.find("#dlg_new_pwd2").attr("disabled",!1),d.find("#dlg_new_show2").attr("disabled",!1))}),d.find(".btn-check").click(function(){var e=$(this).parent();1==$(this).is(":checked")?(e.find("[type=password]").attr("type","text"),e.find(".fa-eye-slash").addClass("fa-eye"),e.find(".fa-eye-slash").removeClass("fa-eye-slash")):($(this).parent().find("[type=text]").attr("type","password"),e.find(".fa-eye").addClass("fa-eye-slash"),e.find(".fa-eye").removeClass("fa-eye"))}),d.find("#dlg_usr_show").click(function(){1==d.find("#dlg_usr_show").is(":checked")?d.find("#dlg_usr_pwd").attr("type","text"):d.find("#dlg_usr_pwd").attr("type","password")}),d.find("#dlg_new_show1").click(function(){1==d.find("#dlg_new_show1").is(":checked")?d.find("#dlg_new_pwd1").attr("type","text"):d.find("#dlg_new_pwd1").attr("type","password")}),d.find("#dlg_new_show2").click(function(){1==d.find("#dlg_new_show2").is(":checked")?d.find("#dlg_new_pwd2").attr("type","text"):d.find("#dlg_new_pwd2").attr("type","password")}),d.find("#modal_ok").click(function(){var e=a(),n=d.find("#dlg_new_pwd1").val();if(null!=n){if(0<n.length){if((n=SHA_256(n))!=SHA_256(d.find("#dlg_new_pwd2").val()))return d.find("#dlg_new_pwd1").focus(),void t("신규 비밀번호를 정확히 입력 하세요.");e.new_pwd=n}n=null}null!=e.usr_name&&e.usr_name.length<=0?t("이름을 입력하세요."):null==e.usr_pwd||e.usr_pwd.length<=0?t("현재 비밀번호를 입력하세요."):l.usr_email==e.usr_email&&l.usr_name==e.usr_name&&l.usr_phone==e.usr_phone&&l.usr_pwd==e.new_pwd||window.SBalance.request("/main/user/update",e).then(function(e){stracer("modal.user_info.html").log("update:",e),null==e.error?t("사용자 정보 업데이트중 알수 없는 오류가 발생했습니다."):"Y"!=e.error.success?t(e.error.message):e.data.affectedRows<=0?t("입력 정보 오류로 사용자 정보 업데이트를 실패 했습니다."):(window.toast({title_class:"bg-success text-white",title_text:"사용자 정보",mesg_text:"사용자 정보가 변경 되었습니다."}),window.dmodal.close(!0))})}),d.find("#modal_del").click(function(){var n=a(),e=`<p style="font-size:18px;">${d.find("#dlg_usr_name").val()} (${d.find("#dlg_usr_email").html()}) 님</p>`+"<p>Sbalance 서비스를 탈퇴 하시겠습니까?</p><p>탈퇴 시, 계정과 공유된 정보들은 영구 삭제되며 복구되지 않습니다.</p>";window.openModal("https://lclasser.github.io/sbalance/pages/main/modal/modal.confirm.html",{title:"탈퇴 확인",content:e,btn_confirm:"탈퇴",btn_cancel:"취소"},function(e){if(null!=e)return n.auth_type="signoff",window.SBalance.request("/sign/authority",n).then(function(e){window.openModal("https://lclasser.github.io/sbalance/pages/modal/modal.verify.signoff.html",n,function(e){window.SBalance.setTimewait(!1),window.SBalance.onSignout(!0,function(){location.href="/"})})})})})})</script>