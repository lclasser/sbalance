const _common_sbalance={setTimewait(e){var n=$("#screen-waitor");1==e?n.css("display","flex"):n.css("display","none")},getReference:function(e,n){return window._refernce=window._refernce||n||{},window._refernce[e]=window._refernce[e]||{},window._refernce[e]}};function createSBalance(){null==window.SBInterface?(window.SBInterface={m_signin:null,getMode:function(){return"web"},showMain:function(){},storeFile:function(e,n,t){},readMessage:function(e,n){return!1},deepLink:function(e,n){null==navigator.share?stracer("SInterface").log("공유하기를 지원하지 않는 환경입니다."):navigator.share({title:"SBalance",text:n,url:""+e+n})},isRememberMe:function(){return null!=this.m_signin&&this.m_signin.is_rememberme},getRememberMe:function(){return JSON.stringify(this.m_signin)},isEnableSMS:function(){return null},setEnableSMS:function(e){},isEnableGPS:function(){return null},setEnableGPS:function(e){},onSignin:function(e,n){return m_signin=e&&JSON.parse(e),1==n?localStorage.setItem("signin",e):localStorage.setItem("signin",""),!0},onSignout:function(){localStorage.setItem("signin",""),m_signin=null}},window.SBInterface.m_signin=localStorage.getItem("signin"),null==window.SBInterface.m_signin||window.SBInterface.m_signin.length<=0?window.SBInterface.m_signin=null:window.SBInterface.m_signin=JSON.parse(window.SBInterface.m_signin),stracer("SInterface").log("load:",window.SBInterface.m_signin),history.pushState(null,null,location.href),window.onpopstate=function(e){history.pushState(null,document.title,location.href),window.SBalance.onBackPressed()}):stracer("SInterface").log("Mobile-Mode..."),window.SBalance={m_cache:{},m_signin:null,m_mframe:null,is_closing:!1,is_waiting:!1,setTimewait:function(e,n){if(1==n){if(1==this.is_waiting)return}else this.is_waiting=e||!0;_common_sbalance.setTimewait(e||!1)},getReference:_common_sbalance.getReference,isEnableSMS:function(){return window.SBInterface.isEnableSMS()},setEnableSMS:function(e){window.SBInterface.setEnableSMS(e)},isEnableGPS:function(){return window.SBInterface.isEnableGPS()},setEnableGPS:function(e){window.SBInterface.setEnableGPS(e)},getMode:function(){return window.SBInterface.getMode()},getArgs:function(e){return e?this._args[e]:this._args},storeFile:function(e,n,t){window.SBInterface.storeFile(e,n,t)},readMessage:function(e,n,t){var a=this;a.m_cache.readMessage={onRead:function(e){n(e)},onFinish:function(e){a.m_cache.readMessage=null,t(e)}},0==window.SBInterface.readMessage(JSON.stringify(e),"SBalance.m_cache.readMessage")&&t(0)},deepLink:function(e){return window.SBInterface.deepLink(""+location.origin,e)},onDeepLink:function(e){stracer("SBalance").log("onDeepLink: params:",e),this._args=parameterFromUrl(e),setTimeout(function(){stracer("SBalance").log("onDeepLink: _args:",this._args),null!=window.SBalance.getSignin()?window.SBalance.onDisplay("main"):window.SBalance.onDisplay("sign")},0)},isRememberMe:function(){return window.SBInterface.isRememberMe()},getRememberMe:function(){return JSON.parse(window.SBInterface.getRememberMe())},getSignin:function(e){return null==this.m_signin?null:null!=e?this.m_signin[e]:this.m_signin},getFrame:function(){return this.m_mframe},setFrame:function(e){this.m_mframe=e},request:function(e,n,o){var i=this,l={then(e){return this.promise=this.promise.then(e),this},catch(e){return this.promise=this.promise.catch(e),this},finally(e){return this.promise=this.promise.finally(e),this},promise:Promise.resolve()};return l.then(function(){return new Promise(function(t,a){i.setTimewait(!0,!0),$.post(e,n).done(function(e){if(e.data=e.data||{},null!=e.error&&"Y"!=e.error.success){var n=parseInt(e.error.code)||null;if(null!=n&&n<0){if(stracer("SBalance").err("request error:",e.error),null!=o)return void o(e.error);setTimeout(function(){window.location="/"},0)}l.catch(function(e){window.toast({title_class:"bg-danger text-white",title_text:"오류",mesg_text:e.message})}),a(e.error)}else t(e)}).fail(function(e,n,t){t=new Error(`서버 응답 오류 입니다. (${t||n})`);l.catch(function(e){window.toast({title_class:"bg-danger text-white",title_text:"오류",mesg_text:e.message})}),a(t)}).always(function(){i.setTimewait(!1,!0)})})}),l},onBackPressed:function(){var t=this,e=!1;null!=window.dpopver&&0<window.dpopver.length?window.dpopver.pop().destroy():null!=window.dmodal&&0!=window.dmodal.isOpen()?window.dmodal.close(null):null!=t.getFrame()?null==t.getFrame().send("backward")&&(stracer("SBalance").log("modal.exit doModal..."),e=!0):e=!0,1==e&&1!=t.is_closing&&(t.is_closing=!0,"web"==window.SBInterface.getMode()?this.onSignout(!1,function(e){t.is_closing=!1}):window.openModal("https://lclasser.github.io/sbalance/pages/modal/modal.exit.html",null,function(e,n){switch(stracer("SBalance").log("modal.exit result:",n),e){case"close":case"exit":t.is_closing=!1,null!=n&&window.SBInterface.exit()}}))},onRefresh:function(){stracer("SBalance").log("onRefresh:",$("page")),this.getFrame()&&this.getFrame().send("refresh")},onSignout:function(e,t){var n;null==this.getFrame()?window.location="/":(n=function(e,n){null!=n&&(window.SBInterface.onSignout(),onMainDestroy(),t&&t(!1),window.location="/?type=passive")},1==e?n(0,!0):window.openModal("https://lclasser.github.io/sbalance/pages/main/modal/modal.signout.html",null,n))},onSignin(e,n){var t;return 1!=e?(window.SBInterface.onSignin(null,!1),this.onDisplay("sign").then(function(){stracer("SBalance").log("SBInterface.onDisplay(null)"),window.SBInterface.showMain()})):(t="sign",n&&1==window.SBInterface.onSignin(JSON.stringify(n),n.is_rememberme)&&(this.m_signin=n,this.getMode(),t="main"),this.onDisplay(t).then(function(){stracer("SBalance").log(`SBInterface.onDisplay(${t})`),window.SBInterface.showMain()}))},onDisplay:function(e){}},window.SBalance._args=parameterFromUrl(location.href),history.replaceState({},null,"/"),stracer("SBalance").log("SBalance._args:",window.SBalance._args),stracer("SBalance").log("createInterface:"+window.SBalance.getMode()+", rememberme:"+window.SBalance.isRememberMe())}function onMainInit(){createSBalance()}function onMainDestroy(){window.SBalance.setFrame(null)}function includePage(o,e){var n;if(null!=e)return n=Promise.resolve(),e.find(`[${o}]`).each(function(e,t){var a=$(t).attr(o);n=n.then(function(){return new Promise(function(n,e){stracer("includePage").log("page loaded:",a),a.indexOf(".html")<0&&(a+=".html"),$.get(a,function(e){$(t).removeAttr(o,""),$(t).html(e),n()})})})}),n}function getStringByCateType(e){switch(e){case"N":return"일반";case"T":return"이체 계좌";case"E":return"예외 (일별만 표시)"}return"(알수 없음)"}function getStringByAccountType(e){switch(e){case"A":return"자동";case"S":return"본인";case"L":return"공유"}return"(알수 없음)"}window.openModal=function(e,n,t){null!=n&&null==t&&"function"==typeof n&&(t=n,n=null);var a=window.dmodal;return null==a&&((a={getReference:_common_sbalance.getReference,$modal:$("#dialog_modal"),_pages:[],_data:null,is_exit:!1,isOpen:function(){return null!=this._data},getParam:function(){return this._data.param},getModal:function(){return this.$modal},exit:function(e){var n=this;stracer("Modal").log("doModal: exit()..."),n._data=n._pages.pop(),null!=n._data&&(n._data.is_keeping=null),n._pages=[],n.is_exit=!0,n.close(e)},close:function(e){stracer("Modal").log("doModal: close()..."),null==this._data?stracer("Modal").log("doModal: close()... already"):(this._data.result=e,stracer("Modal").log("doModal: close()... hide"),this.$modal.modal("hide"))},_open:function(){var e,n=this;stracer("Modal").log("doModal: _open",n._data),n._data=n._pages.shift(),null==n._data?(stracer("Modal").log("doModal: _data clear."),n.is_exit=null):(n._data.is_keeping=null,_common_sbalance.setTimewait(!0),e=n._data.file,$.get(e,function(e){n.$modal.ready(function(){stracer("Modal").log("doModal: onready...",n.$modal),n.$modal.modal("show")}),n.$modal.html(e)}).catch(function(e){stracer("Modal").log("doModal: get err:",e),n.close(),401==e.status&&(window.location="/")}).always(function(){_common_sbalance.setTimewait(!1)}))}}).$modal.on("hidden.bs.modal",function(){stracer("Modal").log("doModal: hidden.bs.modal... 1"),a.$modal.empty();var n=a._data;return a._data=null,Promise.resolve().then(function(){var e;if(stracer("Modal").log("doModal: hidden.bs.modal... 2"),null!=n&&1!=n.is_keeping)return e=n.callback,n.callback=null,stracer("Modal").log(">>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>> result callback...:",n),e&&e("close",n.result,n.param)}).then(function(){var e,n=a._data;if(1==a.is_exit){if(a._data=null,(a.is_exit=null)!=n)return e=n.callback,n.callback=null,stracer("Modal").log(">>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>> exit callback...:",n),e&&e("exit",n.result,n.param)}else a._open()})}),a.$modal.on("shown.bs.modal",function(){stracer("Modal").log("doModal: shown.bs.modal..."),a.$modal.focus(),a._data.callback&&a._data.callback("show",null,a._data.param)}),window.dmodal=a),null!=a._data&&1!=self.is_exit&&(a._data.is_keeping=!0,a._pages.unshift(a._data)),stracer("Modal").log("window.openModal: starting..."),a._pages.unshift({file:e,param:n,callback:t,result:null}),null==a._data&&a._pages.length<=1?(stracer("Modal").log("window.openModal: openning..."),a._open()):(stracer("Modal").log("window.openModal: closing..."),a.close()),a},window.toast=function(e){function n(e,n){var t=e.find(".toast-header"),t=(t.find(".toast-title").html(n.title_text),n.title_class&&(t.attr("class","toast-header"),t.addClass(n.title_class),t.find("button").attr("class","btn").addClass(n.title_class)),e.find(".toast-body"));t.attr("class","toast-body"),t.html(n.mesg_text),n.mesg_class&&t.addClass(n.mesg_class),e.parent().css("display","block"),window.dtoast.toast=new bootstrap.Toast(e[0],{delay:3e3}),window.dtoast.toast.show()}var t;window.dtoast=window.dtoast||{toast:null,queue:[]},null==window.dtoast.toast?null==(t=$("#alert_toast"))||t.length<=0||(n(t,e),t.on("hidden.bs.toast",function(){var e;null!=window.dtoast&&(0<window.dtoast.queue.length?(e=window.dtoast.queue.shift(),n(t,e)):(t.parent().css("display","none"),window.dtoast=null))})):window.dtoast.queue.push(e)},window.popver=function(i,e,n){var l=$('<div class="w-100 h-100 position-fixed left-0 top-0" style="z-index:1060;background-color:#000;opacity: .5;"></div>'),s=$('<div class="w-100 h-100 position-fixed left-0 top-0" tabindex="-1" style="z-index:1065; display:none;"></div>');function r(e,t){e.each(function(e,n){n=Function(n.getAttribute(t));null!=n&&n.call(a)})}$("body").append(s),_common_sbalance.setTimewait(!0);var a={$body:s,find:function(e){return this.$body.find(e)},getPage:function(){return this.$body.find("page")},getParam:function(){return e},_open:function(e,n,t){var a=this,o=i;window.dpopver=window.dpopver||[],window.dpopver.push(a),$.get(o,function(e){stracer("Popver").log("self.$body:",a.$body),a.$body.ready(function(){$("body").append(l),r(a.$body.children("page"),"onload"),s.show(),s.focus()}),a.$body.html(e),r(a.$body.children("page"),"onopen"),s.find("[data-bs-dismiss]").unbind("click"),s.find("[data-bs-dismiss]").click(function(e){stracer("Popver").log("click:",e),a.close(),e.preventDefault()}),_common_sbalance.setTimewait(!1)}).catch(function(e){stracer("Popver").error(e),a.close(),_common_sbalance.setTimewait(!1)})},close:function(e){window.dpopver.pop(),this.destroy(e)},destroy:function(e){s.remove(),l.remove(),r(this.$body.children("page"),"onclose"),n&&n(e),n=null}},t=(a._open(i,e,n),s[0].addEventListener("mousedown",function(e){var n,t=$(this).find(".modal-content");null==t||t.length<=0||(t=(t=t[0]).getClientRects()[0],n=!1,1!=(n=e.clientX>=t.left&&e.clientX<=t.right&&e.clientY>=t.top&&e.clientY<=t.bottom?!0:n)&&a.close())}),document.activeElement);return s[0].addEventListener("keydown",function(e){stracer("Popver").log("keydown:",e),"Escape"==e.key&&(a.close(),null!=t)&&$(t).focus()}),a};